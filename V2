
function searchFilesByLastModifiedUserInFolder(parentFolderId, userEmail, fileNamePrefix) {
  var files = [];
  var parentFolder = DriveApp.getFolderById(parentFolderId);

  function searchInFolder(folder) {
    var folderFiles = folder.getFiles();
    while (folderFiles.hasNext()) {
      var file = folderFiles.next();
      var fileId = file.getId();
      var fileDetails = Drive.Files.get(fileId, { fields: 'lastModifyingUser, modifiedTime, name' });

      var lastModifyingUser = fileDetails.lastModifyingUser;
      if (lastModifyingUser && lastModifyingUser.emailAddress === userEmail && file.getName().indexOf(fileNamePrefix) === 0) {
        var fileUrl = 'https://drive.google.com/file/d/' + fileId + '/view';
        files.push({
          name: file.getName(),
          url: fileUrl
        });
        Logger.log('File matched: ' + file.getName() + ', URL: ' + fileUrl); // Log matched file name and URL
      }
    }

    var subfolders = folder.getFolders();
    while (subfolders.hasNext()) {
      searchInFolder(subfolders.next());
    }
  }

  searchInFolder(parentFolder);

  Logger.log(files);
  return files;
}
